# Настройка Google Analytics

Этот проект поддерживает интеграцию с Google Analytics 4 (GA4) для отслеживания посетителей и взаимодействий на сайте.

## Быстрая настройка

### 1. Получение Measurement ID

1. Перейдите в [Google Analytics](https://analytics.google.com/)
2. Создайте новое свойство или выберите существующее
3. В разделе "Администрирование" → "Потоки данных" найдите ваш веб-поток
4. Скопируйте **Measurement ID** (формат: `G-XXXXXXXXXX`)

### 2. Настройка в config.yaml

Откройте файл `config.yaml` и найдите секцию `analytics`:

```yaml
# Аналитика
analytics:
  # Google Analytics 4
  googleAnalytics:
    enabled: true
    measurementId: "G-XXXXXXXXXX"  # Замените на ваш Measurement ID
    
  # Дополнительные настройки отслеживания
  tracking:
    # Отслеживание кликов по внешним ссылкам
    externalLinks: true
    # Отслеживание скачиваний файлов
    downloads: true
    # Отслеживание прокрутки страницы
    scrollTracking: true
    # Отслеживание времени на странице
    timeOnPage: true
```

### 3. Замените Measurement ID

Замените `G-XXXXXXXXXX` на ваш реальный Measurement ID:

```yaml
measurementId: "G-1234567890"  # Ваш реальный ID
```

### 4. Пересоберите сайт

Запустите сборку проекта:

```bash
npm run build
# или
node build-all.js
```

## Что отслеживается

### Базовые события

- **Просмотры страниц** - автоматически отслеживаются при загрузке
- **Время на странице** - отправляется каждые 30 секунд
- **Уход со страницы** - общее время сессии

### Взаимодействия

- **Клики по кнопкам** - все кнопки и элементы с классом `.btn`
- **Навигация по разделам** - клики по якорным ссылкам (`#projects`, `#documentation`)
- **Внешние ссылки** - клики по ссылкам на другие сайты
- **Скачивания файлов** - клики по ссылкам на файлы (.pdf, .doc, .zip и др.)

### Прокрутка страницы

Отслеживаются milestone прокрутки:
- 25% страницы
- 50% страницы  
- 75% страницы
- 90% страницы

## Настройка отслеживания

Вы можете включить/выключить различные типы отслеживания в `config.yaml`:

```yaml
tracking:
  externalLinks: false    # Отключить отслеживание внешних ссылок
  downloads: false        # Отключить отслеживание скачиваний
  scrollTracking: false   # Отключить отслеживание прокрутки
  timeOnPage: false       # Отключить отслеживание времени
```

## Отключение аналитики

Чтобы полностью отключить Google Analytics:

```yaml
analytics:
  googleAnalytics:
    enabled: false
```

## Проверка работы

### В браузере

1. Откройте ваш сайт
2. Откройте Developer Tools (F12)
3. Перейдите на вкладку "Network"
4. Обновите страницу
5. Найдите запросы к `google-analytics.com` или `googletagmanager.com`

### В Google Analytics

1. Перейдите в Google Analytics
2. Откройте "Отчеты" → "Реальное время"
3. Откройте ваш сайт в другой вкладке
4. Проверьте, что появился активный пользователь

## Пользовательские события

Вы можете добавить собственные события в `assets/script.js`:

```javascript
// Отслеживание пользовательского события
trackEvent('custom_action', {
  event_category: 'user_interaction',
  event_label: 'button_name',
  value: 1
});
```

## Конфиденциальность

Этот код использует стандартные настройки Google Analytics 4, которые соответствуют требованиям GDPR. Рекомендуется:

1. Добавить уведомление о cookies на сайт
2. Предоставить возможность отказа от отслеживания
3. Обновить политику конфиденциальности

## Отладка

Если аналитика не работает:

1. Проверьте правильность Measurement ID
2. Убедитесь, что `enabled: true` в конфигурации
3. Проверьте консоль браузера на ошибки
4. Убедитесь, что не блокируется AdBlock или подобными расширениями

## Дополнительные настройки

### Пользовательские параметры

Вы можете добавить пользовательские параметры в `components/analytics.js`:

```javascript
gtag('config', 'G-XXXXXXXXXX', {
  page_title: document.title,
  page_location: window.location.href,
  custom_map: {
    'custom_parameter_1': 'project_type',
    'custom_parameter_2': 'documentation_section'
  }
});
```

### Исключение IP-адресов

В Google Analytics можно исключить ваш IP-адрес из отслеживания:

1. Перейдите в "Администрирование" → "Потоки данных"
2. Выберите ваш поток данных
3. Нажмите "Настроить теги"
4. Добавьте фильтр для исключения внутреннего трафика